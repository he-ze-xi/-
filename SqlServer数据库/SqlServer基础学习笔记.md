@[TOC](目录)
![在这里插入图片描述](https://img-blog.csdnimg.cn/484cd0778df54a5cb1a13e0ef2b5238f.jpeg#pic_center)

# 1.SqlServer 简介
## 1.什么是数据库

> 数据库是结构化信息或数据（一般以电子形式存储在计算机系统中）的有组织的集合，通常由数据库管理系统 (DBMS) 来控制。在现实中，数据、DBMS 及关联应用一起被称为数据库系统，通常简称为数据库。

> 为了提高数据处理和查询效率，当今最常见的数据库通常以行和列的形式将数据存储在一系列的表中，支持用户便捷地访问、管理、修改、更新、控制和组织数据。另外，大多数数据库都使用结构化查询语言
> ( SQL ) 来编写和查询数据。
## 2.结构化查询语言 (SQL ) 是什么？
### 1.简介
> SQL 是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统。与其他程序设计语言（如 C#语言、Java
> 等）不同的是，SQL 由很少的关键字组成，每个 SQL 语句通过一个或多个关键字构成。
> 1. 一体化：SQL 集数据定义、数据操作和数据控制于一体，可以完成数据库中的全部工作。
> 2. 使用方式灵活：SQL 具有两种使用方式，可以直接以命令方式交互使用；也可以嵌入使用，嵌入 C、C++、Fortran、COBOL、Java 等语言中使用。
> 3. 非过程化：只提操作要求，不必描述操作步骤，也不需要导航。使用时只需要告诉计算机“做什 么”，而不需要告诉它“怎么做”，存储路径的选择和操作的执行由数据库管理系统自动完成。
> 4. 语言简洁、语法简单：该语言的语句都是由描述性很强的英语单词组成，而且这些单词的数目不 多。

> SQL 包含以下 几 部分：用来创建或删除数据库以及表等对象，主要包含以下几种命令： 
> 1. DROP：删除数据库和表等对象。
> 2. CREATE：创建数据库和表等对象。
> 3. ALTER：修改数据库和表等对象的结构。

### 2.数据操作语言（Data Manipulation Language，DML）

> 用来变更表中的记录，主要包含以下几种命令： 
> 1. SELECT：查询表中的数据。
> 2.  INSERT：向表中插入新数据 。
> 3. UPDATE：更新表中的数据。
> 4. DELETE：删除表中的数据。
### 3.数据查询语言（Data Query Language，DQL）
> 用来查询表中的记录，主要包含 SELECT 命令，来查询表中的数据。
> 用来确认或者取消对数据库中的数据进行的变更。除此之外，还可以对数据库中的用户设定权限。主要包含以下几种命令： 
> 1. GRANT：赋予用户操作权限。
> 2. REVOKE：取消用户的操作权限。
> 3.  COMMIT：确认对数据库中的数据进行的变更。
> 4.  ROLLBACK：取消对数据库中的数据进行的变更。
## 3.数据库的发展历程
> 目前几乎所有的关系数据库都使用 SQL 编程语言来查询、操作和定义数据，进行数据访问控制。 SQL最初于 20 世纪 70 年代由 IBM 开发，当时 Oracle 是一个主要的贡献者，这推动了 SQL ANSI 标准的实施，而 SQL 的兴起也刺激了 IBM、Oracle 和 Microsoft 等公司开始全面扩张。时至今日，虽然 SQL仍被广泛使用，但是新的编程语言也已经崭露头角。

> 自 20 世纪 60 年代初诞生至今，数据库已经发生了翻天覆地的变化。最初，人们使用分层数据库（树形模型，仅支持一对多关系）和网络数据库（更加灵活，支持多种关系）这样的导航数据库来存储和操 作数据。这些早期系统虽然简单，但缺乏灵活性。20世纪 80 年代，关系数据库开始兴起；20 世纪 90年代，面向对象的数据库开始成为主流。最近，随着互联网的快速发展，为了更快速地处理非结构化数 据，NoSQL数据库应运而生。现在，云数据库和自治驾驶数据库在数据收集、存储、管理和利用方面 正不断取得新的突破。
## 4. 数据库与Excel等电子表格有何区别？
> 数据库和电子表格（例如 Microsoft Excel）都可以便捷地存储信息，两者的主要区别包括：
> 1. 存储和操作数据的方式。
> 2. 谁可以访问数据。
> 3. 可以存储多少数据。

> 从一开始，电子表格就是专门针对单一用户而设计的，其特性也反映了这一点。电子表格非常适合不需要执行太多高度复杂的数据操作的单一用户或少数用户。另一方面，数据库的设计是为了保存大量有组织的信息，有时是海量的。数据库允许多个用户同时使用高度复杂的逻辑和语言，快速、安全地访问和
> 查询数据。
## 5.数据库的类型
> 数据库有很多种，至于各种数据库孰优孰劣，主要取决于企业希望如何使用数据：
> 1. 关系数据库：关系数据库在 20 世纪 80 年代成为主流。关系数据库中的项被组织为一系列具有列和行的表。关系数据库技术为访问结构化信息提供了最有效和灵活的方法。
> 2. 面向对象数据库：面向对象数据库中的信息以对象的形式表示，这与面向对象的编程相类似。
> 3. 分布式数据库：分布式数据库由位于不同站点的两个或多个文件组成。数据库可以存储在多台计算机上，位于同一个物理位置，或分散在不同的网络上（TIDB）。
> 4. 数据仓库：数据仓库是数据的中央存储库，是专为快速查询和分析而设计的数据库。
> 5. NoSQL 数据库：NoSQL 或非关系数据库，支持存储和操作非结构化及半结构化数据（与关系数据库相反，关系数据库定义了应如何组合插入数据库的数据）。随着 Web
> 应用的日益普及和复杂化， NoSQL 数据库得到了越来越广泛的应用。
> 6. 图形数据库：图形数据库根据实体和实体之间的关系来存储数据。
> 7. OLTP 数据库： OLTP 数据库是一种高速分析数据库，专为多个用户执行大量事务而设计。

> 这些只是目前投入使用的几十种数据库中的一小部分。另外还有许多针对具体的科学、财务或其他功能而定制的不太常见的数据库。除了不同的数据库类型之外，技术开发方法的变化以及云和自动化等重大进步也在推动数据库朝新的方向发展。一些最新的数据库包括：
> 1. 开源数据库：开源数据库系统是指源代码为开放源码的数据库系统，它可以是 SQL 或 NoSQL 数据库。(PostgreSQL,MySql)
> 2. 云数据库：云数据库指位于私有云、公有云或混合云计算平台上的结构化或非结构化数据集合。云数据库模式分为两类：传统模式和数据库即服务 ( DBaaS )。在 DBaaS 中，管理任务和维护由服务 提供商执行。 B站:任我行码农场
> 3. 多模型数据库：多模型数据库将不同类型的数据库模型结合到一个集成的后端中。这意味着它们可以支持各种不同的数据类型。
> 4. 文档/ JSON 数据库：文档数据库专为存储、检索和管理面向文档的信息而设计，是一种以 JSON格式存储数据的现代方法，而不是采用行和列的形式。
> 5. 自治驾驶数据库：基于云的自治驾驶数据库（也称作自治数据库）是一种全新的极具革新性的数据库，它利用机器学习技术自动执行数据库调优、保护、备份、更新，以及传统上由数据库管理员(
> DBA ) 执行的其他常规管理任务。
## 6.数据库软件是什么？
> 数据库软件旨用于创建、编辑和维护数据库文件及记录，帮助用户更轻松地执行文件和记录创建、数据录入、数据编辑、更新和报告等操作。除此之外，数据库软件还能处理数据存储、备份和报告以及多路访问控制和安全性等问题。随着当今数据盗窃日益频繁，数据库安全性已变得至为重要。数据库软件有时也称为“数据库管理系统”
> (DBMS)。
> 数据库软件支持用户以结构化形式存储数据然后访问数据，能够极大简化数据管理。它一般会提供图形界面来简化数据创建和管理，在某些情况下，用户可以使用数据库软件来自行构建数据库。
## 7.数据库管理系统 (DBMS) 是什么？
> 数据库通常离不开完备的数据库软件程序，也就是数据库管理系统 (DBMS)。DBMS充当数据库与其用户或程序之间的接口，允许用户检索、更新和管理信息的组织和优化方式。此外，DBMS还有助于监督和控制数据库，提供各种管理操作，例如性能监视、调优、备份和恢复。

> 常见的数据库软件或 DBMS 有 MySQL 、Microsoft Access、 Microsoft SQL Server 、FileMakerPro 、Oracle Database 和 dBASE , ProgreSQL。
## 8.简单认识 SQL Server
> 1. SQL Server 是 Microsoft 开发的一个关系数据库管理系统( RDBMS )，现在是世界上最为常用的数据库之一；
> 2. SQL Server 是一个高度可扩展的产品，可以从一个单一的笔记本电脑上运行的任何东西或以高倍云服务器网络，或在两者之间任何东西。虽然说是“任何东西”，但是仍然要满足相关的软件和硬件的要求；
> 3. SQL Server 1.0 在1989年发布，至今 SQL Server 已成为一个真正的企业信息化平台。 SQLServer 2014 包括内置的商务智能工具，以及一系列的分析和报告工具，可以创建数据库、备份、复制、安全性更好以及更多。
## 9.为什么要使用SqlServer ?
> 1. 数据持久化 ：指的是 可以存储在磁盘中。
> 2.  高效的存储与查询。
> 3.  数据共享。
> 4.  .Net 首选，因为与 SqlServer 同属于微软。
## 10.SQL Server 基本服务介绍
### 1.SQL Server 服务器类型
> Sql Server 提供了四种服务器类型：
>  1. 数据库引擎 。
>  2. Analysis Services (分析服务 ) 。
>  3. Reporting Services (报告服务)。
>  4. Integration Services (集成服务)。
> 
> 

> 1. 数据库引擎 (核心服务)：
>  是 Sql Server 的核心服务 他是存储和处理表格关系格式的数据或 xml 文档格式的数据服务。负责完成数据存储，处理，和安全。
> 2. Analysis Services (分析服务 ) ：
>  Analysis Services 主要是通过服务器和客户端 提供联机分析和处理和数据挖掘功能。（有了它用户可以创建，管理来自于其他数据源的数据结构）（联机事物的处理是由数据库引擎来完成的）。
>  
> 3. Reporting Services (报表服务)：
>  Reporting Services 用来做基于服务器的解决方案：他可以用来生成各种报表方便工作。
>  
> 4. Integration Services (集成服务)：
>  Integration Services 是一个数据集成的平台，负责完成有关数据的提取，转换，加载，集成服务包括生成并调试包的图形工具和向导；执行如数据导入、导出， FTP 操作，SQL 语句执行和电子邮件消息传递等工作流功能的任务等。
### 2.系统数据库
> 1. Master:主系统数据库,记录了系统级别的信息,并且记录了登录账户,系统配置和已连接的服务信息。
> 2. Model:模板数据库.保存了创建数据库所需要的模板信息。
> 3. Tempdb :临时数据库,保存所有的临时表信息和临时存储过程。
> 4. Msdb :记录代理程序的调度信息,警报,作业等信息。
# 2.数据库操作
### 1.数据库文件组成
#### 1.主数据文件(.mdf)
> 1. 要数据文件的建议文件扩展名是 .mdf 。
> 2. 主要数据文件包含数据库的启动信息，并指向数据库中的其他文件，存储部分或全部的数据。用户数据和对象可存储在此文件中，也可以存储在次要数据文件中。
> 3. 每个数据库有一个主要数据文件。 mdf 文件并非普通文件，因此不借助相应软件是无法打开 mdf 文件的。打开 mdf 文件的常用虚拟光驱软件，主要有：Daemon Tools 、东方光驱魔术师等。
#### 2.次要数据文件(*.ndf)
> 1. 次要数据文件的建议文件扩展名是 . ndf 。
> 2. 次要数据文件是可选的，由用户定义并存储用户数据，用于存储主数据文件未能存储的剩余数据和一些数据库对象。
> 3. 通过将每个文件放在不同的磁盘驱动器上，次要文件可用于将数据分散到多个磁盘上。
> 4. 如果数据库超过了单个 Windows 文件的最大大小，可以使用次要数据文件，这样数据库就能继续增长。
#### 3.事务日志(*.ldf)
> 1. 事务日志的建议文件扩展名是 . ldf 。
> 2. 事务日志文件保存用于恢复数据库的事务日志信息。数据库的插入、删除、更新等操作都会记录在日志文件中，而查询不会记录在日志文件中。整个的数据库有且仅有一个日志文件。
> 3. 每个数据库必须至少有一个日志文件。
### 2.文件组
> 不同的文件可以存分布到不同的物理硬盘上，这样便于分散硬盘IO，提高数据的读取速度。 数据文件的组合，称作文件组（File Group），数据库不能直接设置存储数据的数据文件，而是通过文件组来指定。
#### 1.文件和文件组的关系
> **SQL Server 的数据存储在文件中，文件是实际存储数据的物理实体，文件组是逻辑对象， SQL Server 通过文件组来管理文件。**
> 

> 一个数据库有一个或多个文件组，其中主文件组（Primary File Group）是系统自动创建的，用户可以根据需要添加文件组。每一个文件组管理一个或多个文件，其中主文件组中包含主要数据文件（*. mdf），主文件组中也可以包含次要数据文件。（主要数据文件是系统默认生成的，并且在数据库中是唯一的；次要数据文件是用户根据需要添加的。）除了主文件组之外，其他文件组只能包含辅助文件。如下示例数据库，系统已自动创建主文件组 PRIMARY，勾选 Default 表示将主文件组设置为默认文件组，即如果在 create table 和 create index时没有指定 FileGroup 选项，那么 SQL Server 将使用默认的 PRIMARY 文件组来存储数据。

![在这里插入图片描述](https://img-blog.csdnimg.cn/00387a6c59e94032923a765cf91dd176.png)

> 文件组是一个逻辑实体，实际上，数据存储在文件中（ .mdf和.ndf ）中，每一个文件组中都包含文件。
#### 2.使用文件组的优势
> 在实际开发数据库的过程中，通常情况下，用户需要关注文件组，而不用关心文件的物理存储，即使DBA改变文件的物理存储，用户也不会察觉到，也不会影响数据库去执行查询。除了逻辑文件和物理文件的分离之外， SQL Server使用文件组还有一个优势，那就是分散IO负载，其实现的原理是：对于单分区表，数据只能存到一个文件组中。如果把文件组内的数据文件分布在不同的物理硬盘上，那么 SQL Server能同时从不同的物理硬盘上读写数据，把IO负载分散到不同的硬盘上。对于多分区表，每个分区使用一个文件组，把不同的数据子集存储在不同的磁盘上，SQL Server 在读写某一个分组的数据时，能够调用不同的硬盘IO。
### 3.数据库操作
#### 1.使用SSMS 方式
> SSMS : Microsoft SqlServer Management Studio ， 也就是数据库管理软件。
![在这里插入图片描述](https://img-blog.csdnimg.cn/52f6fbd1f84b4aa29311131f3e739430.png)
就是上图这种通过图形化界面来创建数据库的方式。
#### 2.T-SQL方式
##### 1.创建数据库
```sql
-- 创建数据库
create database 第二单元测试
-- 指定数据文件存储的文件组 on:在。。。。这上，primary:主文件组
on primary
(
-- 数据库的逻辑名称:相当于是某人的外号
Name = '第二单元测试', -- 逻辑名称需要是唯一
filename = 'D:\test\第二单元测试_物理名称.mdf', -- 物理名称
size=5mb, -- 文件初始大小，初始化必须>=5 ,因为创建数据库的model 模板信息 必须是
5mb以上
filegrowth = 4mb, -- 每次增长多少
maxsize =200mb -- 文件的最大值
);
```
##### 2.创建次文件
```sql
alter database 第二单元测试
add file
(
-- 数据库的逻辑名称:相当于是某人的外号
Name = '第二单元测试_次文件',
filename = 'E:\test\第二单元测试_次文件.ndf', -- 物理名称
size=5mb, -- 文件初始大小，初始化必须>=5 ,因为创建数据库的model 模板信息 必须是
5mb以上
filegrowth = 4mb, -- 每次增长多少
maxsize =200mb -- 文件的最大值
)
```
##### 3.简化创建数据库(初学者推荐)
```sql
-- create database <数据库名称>;
create database 任我行教学管理系统
```
##### 4.删除数据库
```sql
-- 切换数据库
use master;
-- drop database <数据库名称>;
drop database 任我行教学管理系统;
```
##### 5.查看数据库信息

```sql
-- exec sp_helpdb '<数据库名称>'
exec sp_helpdb 'Soa模拟考试'
```
##### 6.修改数据库名称
```sql
-- exec sp_renamedb '<需要修改的数据库的名称>','<新的数据库名称>' ;
exec sp_renamedb
'第二单元测试', -- 需要修改的数据库的名称
'第二单元' -- 新的数据库名称
```
##### 7.切换数据库
```sql
-- use <数据库名称>
use 任我行教学管理系统;
```
### 4.备份与还原

> 可能有一天，数据库遭黑客攻击，数据库遭破坏，这个时候就需要时常的做文件的备份。也有可能公司来了一个马大哈，把数据库给删除（删库跑路），这个时候也需要备份。

#### 1.备份
```sql
-- backup database <数据库名称> to disk = '磁盘路径';
backup database 第二单元测试 to disk ='D:\test\第二单元测试.bak';
```
#### 2.还原
1. 数据库不存在的情况下：
```sql
-- restore database <数据库名称> from disk = '磁盘路径'
restore database 第二单元测试 from disk = 'D:\test\第二单元测试.bak'
```
2. 数据库存在的情况下：

```sql
-- with replace:替换
-- restore database <数据库名称> from disk = '磁盘路径' with replace;
restore database 第二单元测试 from disk = 'E:\test\第二单元测试.bak' with
replace;
```
### 5. 附加与分离

> 假设我有一个比较好的数据库，大家都想要，我可以发给你们，但是直接发送不了，因为会提示“这个文件在数据库 SqlServer 中打开”，这个时候就需要使用分离，将这个数据库文件从SqlServer 中 分离出去。

> 现在数据库已经分离并且数据库也发给你们了，我自己也想要用这个数据库，这个时候就要重新的附加到 SQLSERVER 中来。
#### 1.分离
```sql
-- execute:执行
-- sp_detach_db：分离的存储过程（理解为一个函数）
-- execute sp_detach_db '<数据库名称>'
execute sp_detach_db 'Soa模拟考试'
```
#### 2.附加
```sql
-- 附加
-- sp_attach_db:附加的存储过程
-- exec sp_attach_db '<数据库名称>','<数据库文件所在路径>' ;
exec sp_attach_db 'Soa模拟考试','C:\Program Files\Microsoft SQL
Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\Soa模拟考试.mdf'
```
# 3.数据类型与表操作
## 1.数据类型
### 1.Character 字符串
![在这里插入图片描述](https://img-blog.csdnimg.cn/3fe460e39a134e5aa0a3554103af7f6a.png)
### 2.Unicode 字符串
![在这里插入图片描述](https://img-blog.csdnimg.cn/e03117ba6a56495983968d10d7a61b0f.png)

### 3.Binary 类型
![在这里插入图片描述](https://img-blog.csdnimg.cn/046763b4f087440093b0a24566c508e5.png)
### 4.Number 类型
![在这里插入图片描述](https://img-blog.csdnimg.cn/f5a265482b1e492e8d661e5f9caf9185.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/34feebc0a67840ec91a1481410e23c72.png)
### 5.Date 类型
![在这里插入图片描述](https://img-blog.csdnimg.cn/2d1c117de8754aa3892e8256675cffcd.png)
### 6.其他数据类型
![在这里插入图片描述](https://img-blog.csdnimg.cn/d3abf36f9bcc488f9262d7d7d5fb18f3.png)
#### 1.C# 中的 类型 对应的 Sql 类型
![在这里插入图片描述](https://img-blog.csdnimg.cn/e8f07501e9cf4cbda28e2fc51a3b2f79.png)
#### 2. Binary 类型可以存储的类型有哪些

```bash
音频，视频，文件（图片）
```
#### 3.常用的数据库类型有哪些
![在这里插入图片描述](https://img-blog.csdnimg.cn/959806f05123459cbf60b653b2f93196.png)
### 7.sql 中的Character和Unicode 区别

> CHAR(n)类型
将 int ASCII 代码转换为字符的字符串函数。参数n是介于 0 和 255 之间的整数。如果整数表达式不在此范围内，将返回 NULL 值。

> nchar 和 nvarchar nchar 是固定长度 Unicode 数据的数据类型， nvarchar 是可变长度 Unicode
> 数据的数据类型，二者 均使用 UNICODE UCS-2 字符集。

> nchar(n) 类型 包含 n 个字符的固定长度 Unicode 字符数据。n 的值必须介于 1 与 4,000 之间。存储大小为 n
> 字节的 两倍。 nchar 在 SQL-92 中的同义词为 national char 和 national character。

> nvarchar(n) 类型 包含 n 个字符的可变长度 Unicode 字符数据。n 的值必须介于 1 与 4,000
> 之间。字节的存储大小是所 输入字符个数的两倍。所输入的数据字符长度可以为零。 nvarchar 在 SQL-92 中的同义词为
> national char varying 和 national character varying。
### 8.Char 与 varchar 对比
> 1. CHAR的长度是不可变的，而VARCHAR的长度是可变的，也就是说，定义一个CHAR[10]和
> VARCHAR[10],如果存进去的是‘ABCD’, 那么CHAR所占的长度依然为10，除了字符‘ABCD’外，后面 跟六个空格，而VARCHAR的长度变为4了，取数据的时候，CHAR类型的要用trim()去掉多余的空 格，而VARCHAR类型是不需要的。
> 2. CHAR的存取速度要比VARCHAR快得多，因为其长度固定，方便程序的存储与查找；但是CHAR 为此付出的是空间的代价，因为其长度固定，所以难免会有多余的空格占位符占据空间，可以说是以空间换取时间效率，而VARCHAR则是以空间效率为首位的。
> 3. CHAR的存储方式是，一个英文字符（ASCII）占用1个字节，一个汉字占用两个字节；而 VARCHAR的存储方式是，一个英文字符占用2个字节，一个汉字也占用2个字节。
> 4. 两者的存储数据都是非unicode的字符数据。
## 2.数据表- table

